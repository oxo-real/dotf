# vim: filetype=neomuttrc

# key binding and macro settings for neomutt
## account specific settings are in: ./<provider_name>/<account_name>/account_config
## for help man neomuttrc


# key bindings

#index
#pager
#browser
#editor
#attach

bind index,pager		i	        noop	# no operation
bind index			\Cf		noop

# general key rebindings
bind attach			<return>	view-mailcap
bind editor			<space>		noop
bind attach			l		view-mailcap
bind pager			l		view-attachments
bind index,pager		g		noop
bind index			gg		first-entry
bind index			G		last-entry
bind pager,browser		gg		top-page
bind pager,browser		G		bottom-page
bind index			h		noop
bind pager,attach		h		exit
bind browser			h		goto-parent
bind pager			j		next-line
bind pager			k		previous-line
bind index			d		noop
bind index			D		delete-message
bind index			u		noop
bind index			U		undelete-message
bind index			L		limit
bind index			l		display-message
bind browser			l		select-entry
bind index,pager,browser	\Cd		half-down
bind index,pager,browser	\Cu		half-up
bind index,pager		S		sync-mailbox
bind index,pager		R		group-reply
bind editor			<Tab>		complete-query

## sidebar keybindings
## (navigate sidebar with control key)
#bind index,pager		\Ch		sidebar-toggle-visible
# [TODO] why can ctrl-h not sidebar-toggle-visible?
bind index,pager		\Cb		sidebar-toggle-visible
bind index,pager		\Ck		sidebar-prev
bind index,pager		\Cj		sidebar-next
bind index,pager		\Cl		sidebar-open
bind index,pager		\Cp		sidebar-prev-new
bind index,pager		\Cn		sidebar-next-new

## mouse navigation
bind index			<down>		next-undeleted	    # mouse wheel down
bind index			<up>		previous-undeleted  # mouse wheel up
bind pager			<down>		noop		    # mouse wheel down
bind pager			<up>		noop		    # mouse wheel up


# macros

##
macro index,pager		a \
"|abook --add-email\n" 'add sender to abook'

##
macro index			\Cr \
"T~U<enter><tag-prefix><clear-flag>N<untag-pattern>.<enter>" "mark all messages as read"

##
macro index			\Cf \
"<enter-command>unset wait_key<enter><shell-escape>read -p 'Enter a search term to find with notmuch: ' x; echo \$x >~/.cache/mutt_terms<enter><limit>~i \"\`notmuch search --output=messages \$(cat ~/.cache/mutt_terms) | head -n 600 | perl -le '@a=<>;chomp@a;s/\^id:// for@a;$,=\"|\";print@a'\`\"<enter>" "show only messages matching a notmuch pattern"

##
macro index			A \
"<limit>all\n" "show all messages (undo limit)"

##
macro index,pager		\cb \
"<pipe-message> urlscan<Enter>" "call urlscan to extract URLs out of a message"

macro attach,compose		\cb \
"<pipe-entry> urlscan<Enter>" "call urlscan to extract URLs out of a message"
